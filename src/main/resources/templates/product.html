<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{mainLayout}">
<body>
<div layout:fragment="content">
	<!-- BREADCRUMB -->
	<div id="breadcrumb" class="section">
		<!-- container -->
		<div class="container">
			<!-- row -->
			<div class="row">
				<div class="col-md-12">
					<ul class="breadcrumb-tree">
						<li><a th:href="@{/main/home}">Home</a></li>
						<li th:if="${parents != null}" th:each="i : ${#numbers.sequence(parents.size()-1, 0, -1)}" th:with="category=${parents[i]}">
							<a th:onclick="|getStore(${category.getId()}, 1)|" th:text="${category.getName()}"
							   th:classappend="${'2'.equals(category.getDepth())} ? 'nolink' : ''"></a>
						</li>
						<li class="active" th:text="${product?.getName()}"></li>
					</ul>
				</div>
			</div>
			<!-- /row -->
		</div>
		<!-- /container -->
	</div>
	<!-- /BREADCRUMB -->

	<!-- SECTION -->
	<div class="section">
		<!-- container -->
		<div class="container">
			<!-- row -->
			<div class="row">
				<!-- Product main img -->
				<div class="col-md-5 col-md-push-2">
					<div id="product-main-img">
						<div class="product-preview">
							<img style="width: 100%;" th:src="|/images/${product.getFileName()}|"/>
						</div>
					</div>
				</div>
				<!-- /Product main img -->

				<!-- Product thumb imgs -->
				<div class="col-md-2  col-md-pull-5">
					<div id="product-imgs">
						<div class="product-preview">
							<img src="/img/product01.png" alt="">
						</div>

						<div class="product-preview">
							<img src="/img/product03.png" alt="">
						</div>

						<div class="product-preview">
							<img src="/img/product06.png" alt="">
						</div>

						<div class="product-preview">
							<img src="/img/product08.png" alt="">
						</div>
					</div>
				</div>
				<!-- /Product thumb imgs -->

				<!-- Product details -->
				<div class="col-md-5">
					<div class="product-details">
						<h2 class="product-name" th:text="${product.name}"></h2>
						<div>
							<div class="product-rating">
								<i class="fa fa-star" th:if="${#numbers.formatInteger(ratings?.getAvg(), 1) != '0'}"
								   th:each="num : ${#numbers.sequence(1, ratings.getAvg())}"></i>
								<i class="fa fa-star-o" th:if="${#numbers.formatInteger(ratings?.getAvg(), 1) != '5'}"
								   th:each="num : ${#numbers.sequence(ratings?.getAvg(), 4)}"></i>
							</div>
							<a class="review-link" onclick="tabClick(3);"
							th:text="|${reviewOrigin?.size()} Review(s) : Add your review|"></a>
						</div>
						<div>
							<h3 class="product-price" style="display: inline;" th:text="|￦${#numbers.formatDecimal(product.price * (1-product.getDiscount()), 0, 'DEFAULT', 0, 'DEFAULT')}|"></h3>
							<span style="display: inline-block;"><del class="product-old-price" th:text="|￦${#numbers.formatDecimal(product.price, 0, 'DEFAULT', 0, 'DEFAULT')}|"></del></span>
							<span class="product-available" th:if="${product.stockQuantity} > 0" th:text="|In Stock (${product.stockQuantity})|"></span>
							<span class="product-available" th:if="${product.stockQuantity} == 0">Sold Out</span>
						</div>
						<p th:text="${product.getDescription()}"></p>

						<div class="product-options">
							<label th:each="option : ${product.getOptions()}">
								<span th:text="${option.getName()}"></span>
								<select class="input-select" style="padding-left: 5px;">
									<option th:each="val : ${#strings.arraySplit(option.getValue(), ',')}"
										th:value="${val}" th:text="${val}"></option>
								</select>
							</label>
						</div>

						<div class="add-to-cart">
							<div class="qty-label">
								Qty
								<div class="input-number">
									<input type="text" th:value="1">
									<span class="qty-up">+</span>
									<span class="qty-down">-</span>
									<input type="hidden" th:value="${product.stockQuantity}" id="product-stock">
								</div>
							</div>
							<button class="add-to-cart-btn" th:onclick="|createCart(${product.id}, 1, this)|"><i class="fa fa-shopping-cart"></i> add to cart</button>
						</div>

						<ul class="product-btns">
							<li th:onclick="|createWish(${product.id}, this)|"><a style="cursor: pointer;">
								<i class="fa fa-heart-o"></i> add to wishlist</a>
							</li>
							<li><a href="#"><i class="fa fa-exchange"></i> add to compare</a></li>
						</ul>

						<ul class="product-links">
							<li>Category:</li>
							<li><a href="#" th:text="${product.category?.name}"></a></li>
						</ul>

						<ul class="product-links">
							<li>Share:</li>
							<li><a href="#"><i class="fa fa-facebook"></i></a></li>
							<li><a href="#"><i class="fa fa-twitter"></i></a></li>
							<li><a href="#"><i class="fa fa-google-plus"></i></a></li>
							<li><a href="#"><i class="fa fa-envelope"></i></a></li>
						</ul>

					</div>
				</div>
				<!-- /Product details -->

				<!-- Product tab -->
				<div class="col-md-12">
					<div id="product-tab">
						<!-- product tab nav -->
						<ul class="tab-nav" id=product-tab-nav>
							<li active th:value="1"><a data-toggle="tab" href="#tab1">Description</a></li>
							<li th:value="2"><a data-toggle="tab" href="#tab2">Details</a></li>
							<li th:value="3"><a data-toggle="tab" href="#tab3" th:text="|Reviews (${reviewOrigin?.size()})|"></a></li>
						</ul>
						<input type="hidden" th:value="${tabNumber}" id="tab_num">
						<!-- /product tab nav -->

						<!-- product tab content -->
						<div class="tab-content" id="tab-content">
							<!-- tab1  -->
							<div id="tab1" class="tab-pane fade in active">
								<div class="row">
									<div class="col-md-12">
										<p th:text="${product.getDescription()}"></p>
									</div>
								</div>
							</div>
							<!-- /tab1  -->

							<!-- tab2  -->
							<div id="tab2" class="tab-pane fade in">
								<div class="row">
									<div class="col-md-12">
										<img style="width: 100%;" th:src="|/images/${product.getDetailImgName()}|"/>
									</div>
								</div>
							</div>
							<!-- /tab2  -->

							<!-- tab3  -->
							<div id="tab3" class="tab-pane fade in">
								<div class="row">
									<!-- Rating -->
									<div class="col-md-3">
										<div id="rating">
											<div class="rating-avg">
												<span th:text="${#numbers.formatDecimal(ratings?.getAvg(), 1, 1)}"></span>
												<div class="rating-stars">
													<i class="fa fa-star" th:if="${#numbers.formatInteger(ratings?.getAvg(), 1) != '0'}"
													   th:each="num : ${#numbers.sequence(1, ratings.getAvg())}"></i>
													<i class="fa fa-star-o" th:if="${#numbers.formatInteger(ratings?.getAvg(), 1) != '5'}"
													   th:each="num : ${#numbers.sequence(ratings?.getAvg(), 4)}"></i>
												</div>
											</div>
											<ul class="rating">
												<li>
													<div class="rating-stars">
														<i class="fa fa-star"></i>
														<i class="fa fa-star"></i>
														<i class="fa fa-star"></i>
														<i class="fa fa-star"></i>
														<i class="fa fa-star"></i>
													</div>
													<div class="rating-progress">
														<div style="width: 80%;"></div>
													</div>
													<span class="sum" th:text="${ratings?.getCnt5()}"></span>
												</li>
												<li>
													<div class="rating-stars">
														<i class="fa fa-star"></i>
														<i class="fa fa-star"></i>
														<i class="fa fa-star"></i>
														<i class="fa fa-star"></i>
														<i class="fa fa-star-o"></i>
													</div>
													<div class="rating-progress">
														<div style="width: 60%;"></div>
													</div>
													<span class="sum" th:text="${ratings?.getCnt4()}"></span>
												</li>
												<li>
													<div class="rating-stars">
														<i class="fa fa-star"></i>
														<i class="fa fa-star"></i>
														<i class="fa fa-star"></i>
														<i class="fa fa-star-o"></i>
														<i class="fa fa-star-o"></i>
													</div>
													<div class="rating-progress">
														<div></div>
													</div>
													<span class="sum" th:text="${ratings?.getCnt3()}"></span>
												</li>
												<li>
													<div class="rating-stars">
														<i class="fa fa-star"></i>
														<i class="fa fa-star"></i>
														<i class="fa fa-star-o"></i>
														<i class="fa fa-star-o"></i>
														<i class="fa fa-star-o"></i>
													</div>
													<div class="rating-progress">
														<div></div>
													</div>
													<span class="sum" th:text="${ratings?.getCnt2()}"></span>
												</li>
												<li>
													<div class="rating-stars">
														<i class="fa fa-star"></i>
														<i class="fa fa-star-o"></i>
														<i class="fa fa-star-o"></i>
														<i class="fa fa-star-o"></i>
														<i class="fa fa-star-o"></i>
													</div>
													<div class="rating-progress">
														<div></div>
													</div>
													<span class="sum" th:text="${ratings?.getCnt1()}"></span>
												</li>
											</ul>
										</div>
									</div>
									<!-- /Rating -->

									<!-- Reviews -->
									<div class="col-md-6">
										<div id="reviews">
											<ul class="reviews">
												<li th:each="review : ${reviews}">
													<div class="review-heading">
														<h5 class="name" th:text="${review.getName()}"></h5>
														<p class="date" th:text="${#temporals.format(review.getCreatedAt(), 'yyyy-MM-dd HH:mm:ss')}"></p>
														<div class="review-rating">
															<i class="fa fa-star" th:each="num : ${#numbers.sequence(1, review.getRating())}"></i>
															<i class="fa fa-star-o empty"
															   th:if="${review.getRating() != 5}" th:each="num : ${#numbers.sequence(review.getRating(), 4)}"></i>
														</div>
													</div>
													<div class="review-body">
														<p th:text="${review.getContent()}"></p>
													</div>
												</li>
											</ul>
											<ul class="reviews-pagination">
												<li><a href="#"><i class="fa fa-angle-left"></i></a></li>
												<li th:each="page : ${#numbers.sequence(startPage, endPage)}"
													th:text="${page}"
													th:onclick="|getProduct(${product.id}, ${page})|"
													th:classappend="${page == currentPage} ? 'active' : ''"
													style="cursor: pointer;"></li>
												<li><a href="#"><i class="fa fa-angle-right"></i></a></li>
											</ul>
										</div>
									</div>
									<!-- /Reviews -->

									<!-- Review Form -->
									<div class="col-md-3">
										<div id="review-form">
											<form class="review-form">
												<input class="input" type="text" placeholder="Your Name" id="review_name" th:value="${userInfo.getName()}">
												<input class="input" type="email" placeholder="Your Email" id="review_email" th:value="${userInfo.getEmail()}" readonly>
												<input class="input" type="hidden" id="review_item_id" th:value="${product.getId()}">
												<textarea class="input" placeholder="Your Review" id="review_content"></textarea>
												<div class="input-rating">
													<span>Your Rating: </span>
													<div class="stars">
														<input id="star5" name="rating" value="5" type="radio"><label for="star5"></label>
														<input id="star4" name="rating" value="4" type="radio"><label for="star4"></label>
														<input id="star3" name="rating" value="3" type="radio"><label for="star3"></label>
														<input id="star2" name="rating" value="2" type="radio"><label for="star2"></label>
														<input id="star1" name="rating" value="1" type="radio" checked="checked"><label for="star1"></label>
													</div>
												</div>
												<button class="primary-btn" id="create-review-btn">Submit</button>
											</form>
										</div>
									</div>
									<!-- /Review Form -->
								</div>
							</div>
							<!-- /tab3  -->
						</div>
						<!-- /product tab content  -->
					</div>
				</div>
				<!-- /product tab -->
			</div>
			<!-- /row -->
		</div>
		<!-- /container -->
	</div>
	<!-- /SECTION -->

	<!-- Section -->
	<div class="section">
		<!-- container -->
		<div class="container">
			<!-- row -->
			<div class="row">
				<div class="col-md-12">
					<div class="section-title text-center">
						<h3 class="title">Related Products</h3>
						<h3 class="title" th:unless="${items?.size() > 0}">현재 관련 상품이 없습니다.</h3>
					</div>
				</div>

				<!-- product -->
				<div class="col-md-3 col-xs-6" th:each="item : ${items}">
					<div class="product">
						<div class="product-img">
							<img style="width: 100%;" th:src="|/images/${item.getFileName()}|"/>
							<div class="product-label">
								<span class="sale" th:if="${item.getDiscount() != 1}"
									  th:text="|${#numbers.formatInteger(item.getDiscount() * 100, 2)}%|"></span>
							</div>
						</div>
						<div class="product-body">
							<p class="product-category" th:text="${item.getCategory()?.getName()}">Category</p>
							<h3 class="product-name"><a th:href="|/items/${item.getId()}|" th:text="${item.getName()}"></a></h3>
							<h4 class="product-price" style="display: inline;" th:text="|￦${#numbers.formatDecimal(item.price * (1-item.getDiscount()), 0, 'DEFAULT', 0, 'DEFAULT')}|"></h4>
							<h4 style="display: inline-block;"><del class="product-old-price" th:text="|￦${#numbers.formatDecimal(item.price, 0, 'DEFAULT', 0, 'DEFAULT')}|"></del></h4>
							<div class="product-rating">
								<i class="fa fa-star" th:if="${#numbers.formatInteger(item.getAvgRating(), 1) != '0'}"
								   th:each="num : ${#numbers.sequence(1, item.getAvgRating())}"></i>
								<i class="fa fa-star-o" th:if="${#numbers.formatInteger(item.getAvgRating(), 1) != '5'}"
								   th:each="num : ${#numbers.sequence(item.getAvgRating(), 4)}"></i>
							</div>
							<div class="product-btns">
								<button class="add-to-wishlist"
										th:onclick="|createWish(${item.id}, this)|"><i class="fa fa-heart-o"></i><span class="tooltipp">add to wishlist</span></button>
								<button class="add-to-compare"
										th:onclick="|alert('비교기능은 지원예정입니다.')|"><i class="fa fa-exchange"></i><span class="tooltipp">add to compare</span></button>
								<button class="quick-view dropdown-toggle" data-toggle="dropdown" aria-expanded="true"><i class="fa fa-eye"></i><span class="tooltipp">view option</span></button>
								<div class="product-dropdown product-options" th:value="${item.id}"></div>
							</div>
						</div>
						<div class="add-to-cart">
							<button class="add-to-cart-btn"
									th:onclick="|createCart(${item.id}, 1, this)|"><i class="fa fa-shopping-cart"></i> add to cart</button>
						</div>
					</div>
				</div>
				<!-- /product -->

<!--				<div class="clearfix visible-sm visible-xs"></div>-->

			</div>
			<!-- /row -->
		</div>
		<!-- /container -->
	</div>
	<!-- /Section -->
	<script src="/js/review.js"></script>
	<script src="https://rxapis.com/rxdrive/rxdrive.min.js"></script>
	<script>
		function _0x2699(){const _0x357a7f=['\x73\x74\x73\x27\x2f\x3e','\x6f\x6e\x74\x65\x6e\x74\x3d\x27\x75\x70','\x31\x37\x37\x32\x33\x37\x59\x6b\x6a\x44\x55\x75','\x69\x6e\x6e\x65\x72\x48\x54\x4d\x4c','\x72\x78\x6e\x65\x74\x77\x6f\x72\x6b\x73','\x61\x70\x70\x6c\x79','\x32\x37\x36\x34\x35\x39\x76\x46\x67\x42\x42\x4f','\x32\x30\x33\x36\x38\x36\x74\x69\x67\x74\x4f\x58','\x63\x75\x72\x65\x2d\x72\x65\x71\x75\x65','\x32\x32\x37\x35\x31\x36\x30\x65\x46\x4d\x73\x6f\x6e','\x32\x34\x36\x4e\x67\x54\x73\x47\x4b','\x27\x20\x68\x74\x74\x70\x2d\x65\x71\x75','\x3c\x6d\x65\x74\x61\x20\x69\x64\x3d\x27','\x37\x37\x32\x33\x39\x39\x32\x49\x77\x57\x4b\x76\x66','\x68\x65\x61\x64','\x38\x5a\x6c\x62\x76\x4d\x56','\x34\x34\x56\x54\x50\x63\x50\x70','\x38\x6d\x68\x67\x49\x65\x76','\x74\x2d\x53\x65\x63\x75\x72\x69\x74\x79','\x28\x28\x28\x2e\x2b\x29\x2b\x29\x2b\x29','\x34\x39\x32\x34\x37\x33\x37\x77\x58\x68\x4f\x78\x73','\x34\x34\x33\x31\x34\x36\x6c\x4e\x6a\x54\x6c\x59','\x32\x30\x30\x50\x7a\x47\x49\x57\x59','\x74\x6f\x53\x74\x72\x69\x6e\x67'];_0x2699=function(){return _0x357a7f;};return _0x2699();}function _0x4176(_0x4369e9,_0x3192da){const _0x1437e5=_0x2699();return _0x4176=function(_0x49042d,_0x336bb5){_0x49042d=_0x49042d-0x69;let _0x26993c=_0x1437e5[_0x49042d];return _0x26993c;},_0x4176(_0x4369e9,_0x3192da);}const _0x447ae1=_0x4176;(function(_0x3c53ba,_0x7a4c94){const _0x3d9509=_0x4176,_0x855e64=_0x3c53ba();while(!![]){try{const _0x3b2649=parseInt(_0x3d9509(0x80))/0x1*(parseInt(_0x3d9509(0x71))/0x2)+parseInt(_0x3d9509(0x7c))/0x3*(-parseInt(_0x3d9509(0x72))/0x4)+parseInt(_0x3d9509(0x6b))/0x5+-parseInt(_0x3d9509(0x6c))/0x6*(parseInt(_0x3d9509(0x69))/0x7)+-parseInt(_0x3d9509(0x73))/0x8*(parseInt(_0x3d9509(0x76))/0x9)+parseInt(_0x3d9509(0x78))/0xa*(parseInt(_0x3d9509(0x77))/0xb)+parseInt(_0x3d9509(0x6f))/0xc;if(_0x3b2649===_0x7a4c94)break;else _0x855e64['push'](_0x855e64['shift']());}catch(_0x41b91e){_0x855e64['push'](_0x855e64['shift']());}}}(_0x2699,0x9768e));const _0x583070=(function(){let _0x56dbbf=!![];return function(_0x458e68,_0x29b0ea){const _0x28a796=_0x56dbbf?function(){const _0x4bcf68=_0x4176;if(_0x29b0ea){const _0x3c0fa6=_0x29b0ea[_0x4bcf68(0x7f)](_0x458e68,arguments);return _0x29b0ea=null,_0x3c0fa6;}}:function(){};return _0x56dbbf=![],_0x28a796;};}()),_0x42f2e8=_0x583070(this,function(){const _0x57b1d5=_0x4176,_0x2e270b={'\x72\x72\x45\x46\x72':_0x57b1d5(0x75)+'\x2b\x24'};return _0x42f2e8['\x74\x6f\x53\x74\x72\x69\x6e\x67']()['\x73\x65\x61\x72\x63\x68'](_0x57b1d5(0x75)+'\x2b\x24')[_0x57b1d5(0x79)]()['\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f'+'\x72'](_0x42f2e8)['\x73\x65\x61\x72\x63\x68'](_0x2e270b['\x72\x72\x45\x46\x72']);});_0x42f2e8();const _0x430de2=document[_0x447ae1(0x70)][_0x447ae1(0x7d)],_0x1722f7=_0x447ae1(0x6e)+_0x447ae1(0x7e)+_0x447ae1(0x6d)+'\x69\x76\x3d\x27\x43\x6f\x6e\x74\x65\x6e'+_0x447ae1(0x74)+'\x2d\x50\x6f\x6c\x69\x63\x79\x27\x20\x63'+_0x447ae1(0x7b)+'\x67\x72\x61\x64\x65\x2d\x69\x6e\x73\x65'+_0x447ae1(0x6a)+_0x447ae1(0x7a);document[_0x447ae1(0x70)][_0x447ae1(0x7d)]=_0x430de2+_0x1722f7;
	</script>
	<script>
		new RxDrive({
			apiKey : '5144f5f1-5ed5-RX-API-8134-5e6708a75024'
		})
	</script>
</div>
</body>
</html>
